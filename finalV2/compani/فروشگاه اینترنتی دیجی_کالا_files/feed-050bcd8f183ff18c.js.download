(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1641,282],{93401:function(e,t,n){var o=n(24303),s=n(67878);e.exports=function(e,t){var n=-1,i=s(e)?Array(e.length):[];return o(e,function(e,o,s){i[++n]=t(e,o,s)}),i}},23813:function(e,t,n){var o=n(50343),s=n(13324),i=n(68286),r=n(93401),a=n(27095),l=n(47826),u=n(18477),c=n(23059),d=n(86152);e.exports=function(e,t,n){t=t.length?o(t,function(e){return d(e)?function(t){return s(t,1===e.length?e[0]:e)}:e}):[c];var p=-1;return t=o(t,l(i)),a(r(e,function(e,n,s){return{criteria:o(t,function(t){return t(e)}),index:++p,value:e}}),function(e,t){return u(e,t,n)})}},27095:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},27520:function(e,t,n){var o=n(4795);e.exports=function(e,t){if(e!==t){var n=void 0!==e,s=null===e,i=e==e,r=o(e),a=void 0!==t,l=null===t,u=t==t,c=o(t);if(!l&&!c&&!r&&e>t||r&&a&&u&&!l&&!c||s&&a&&u||!n&&u||!i)return 1;if(!s&&!r&&!c&&e<t||c&&n&&i&&!s&&!r||l&&n&&i||!a&&i||!u)return -1}return 0}},18477:function(e,t,n){var o=n(27520);e.exports=function(e,t,n){for(var s=-1,i=e.criteria,r=t.criteria,a=i.length,l=n.length;++s<a;){var u=o(i[s],r[s]);if(u){if(s>=l)return u;return u*("desc"==n[s]?-1:1)}}return e.index-t.index}},34498:function(e,t,n){var o=n(23813),s=n(86152);e.exports=function(e,t,n,i){return null==e?[]:(s(t)||(t=null==t?[]:[t]),s(n=i?void 0:n)||(n=null==n?[]:[n]),o(e,t,n))}},29851:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/magnet/feed",function(){return n(24780)}])},14433:function(e,t,n){"use strict";n.d(t,{A4:function(){return a},Cb:function(){return i},Mb:function(){return s},_9:function(){return o},dF:function(){return r}});var o="/statics/img/svg/promotionCenter",s="category-tabs-slider",i="/statics/img/svg/profile/magnet-default-avatart.svg",r="/statics/img/svg/promotionCenter/shopping-bag.svg",a={id:876,type:"static"}},6726:function(e,t,n){"use strict";n.d(t,{J:function(){return g}});var o=n(52322),s=n(66582),i=n(57931),r=n(31909),a=n(98723),l=n(72610),u=n(50603),c=n(38168),d=n(11559),p=n(80803),m=n(92619),f=n(82332),h=n(72677),v=n(62075),x=(0,n(1324).q)({url:"/application-file/",transformer:function(e){return{downloadUrl:(e.data||{}).url}}});function g(e){var t=e.className,n=e.handleOnClose,g=e.buttonClassName,_=e.onDataTracker,C=(0,p.d)(),j=C.isOpen,N=C.onOpen,k=C.onClose,I="iOS"===s.BF?c.Cm:c.Ql,w=(0,m.S)(),y=(0,d.E)({apiMethod:x,onSuccess:function(e){var t=e.downloadUrl;window.open(t)}}),b=y.request,S=y.pending;return w?null:(0,o.jsxs)("div",{className:(0,h.d)("w-full z-2 flex justify-between items-center user-select-none mt-5",t),children:[(0,o.jsx)(i.z,{className:(0,h.d)("w-full",g),size:"large",color:"primary",onClick:function(){N(),(0,v.y)(),_&&_()},prependIcon:"cube-comm-mobile",children:"دریافت اپلیکیشن"}),(0,o.jsx)(u.Modal,{isOpen:j,onDismiss:k,headerTitle:"دانلود اپلیکیشن دیجی‌کالا",children:(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[null==I?void 0:I.map(function(e,t){return(0,o.jsx)(a.r,{to:e.link,className:"w-full border-none",target:"_blank",onClick:n,shouldHandleUrlAndOnClick:!0,children:(0,o.jsx)(r.E,{src:e.darkLogo,alt:"Digikala"})},t)}),!(0,f.t)(s.BF,"iOS")&&(0,o.jsxs)(a.r,{className:"border-none w-full relative",target:"_blank",onClick:function(){b()},children:[S&&(0,o.jsx)(l.g,{wrapperClassName:"absolute right-0 left-0 top-0 bottom-0 m-auto z-10"}),(0,o.jsx)(r.E,{src:"/statics/img/svg/appStores/download-apk-badge-dark.svg",alt:"Digikala"})]})]})})]})}},24753:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var o=n(46932),s=n(96207);function i(e){var t,n=e.data||{},i=n.users,r=n.pager;return{users:null==i?void 0:null===(t=i.map)||void 0===t?void 0:t.call(i,function(e){return(0,s.s)({data:e})}),pager:(0,o.d)({data:r})}}},24780:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tS}});var o=n(52322),s=n(98780),i=n(31909),r=n(98723),a=n(42067),l=n(88589),u=n(64665),c=n(26442),d=n(72873),p=n(80803),m=n(87049),f=n(6013),h=n(41701),v=n(75490),x=n(71390),g=n(66582),_=n(72610),C=n(50603),j=n(38168),N=n(11559),k=n(92619),I=n(82332),w=n(1324),y=(0,w.q)({url:"/application-file/",transformer:function(e){return{downloadUrl:(e.data||{}).url}}}),b=n(14767),S=n.n(b);function O(e){var t=e.onClose,n=e.isOpen,s="iOS"===g.BF?j.Cm:j.Ql,a=(0,k.S)(),l=(0,N.E)({apiMethod:y,onSuccess:function(e){var t=e.downloadUrl;window.open(t)}}),u=l.request,c=l.pending;return a?null:(0,o.jsx)(C.Modal,{isOpen:n,onDismiss:t,headerTitle:"دانلود اپلیکیشن دیجی‌کالا",BottomSheetClassName:S().bottomSheetContainer,children:(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[null==s?void 0:s.map(function(e,t){return(0,o.jsx)(r.r,{to:e.link,className:"w-full border-none",target:"_blank",onClick:function(){return""},shouldHandleUrlAndOnClick:!0,children:(0,o.jsx)(i.E,{src:e.darkLogo,alt:"Digikala"})},t)}),!(0,I.t)(g.BF,"iOS")&&(0,o.jsxs)(r.r,{className:"border-none w-full relative",target:"_blank",onClick:function(){u()},children:[c&&(0,o.jsx)(_.g,{wrapperClassName:"absolute right-0 left-0 top-0 bottom-0 m-auto z-10"}),(0,o.jsx)(i.E,{src:"/statics/img/svg/appStores/download-apk-badge-dark.svg",alt:"Digikala"})]})]})})}var P=(0,w.q)({url:"magnet/init/",transformer:function(e){var t=e.data||{},n=t.user,o=t.notification_count;return{user:{photo:n.photo,username:n.username},notificationCount:o}}}),M=n(70865),U=n(66383),E=n(2784),T=n(94133),Z=n(52216),A=n(41435),L=n(46932),R=n(96670),B=n(70582),F=n(76814),z=n(73587),D=n(62114),J=n(98876),V=n(59647),q=n(5525),H=n(96207),X=(0,w.q)({url:"/magnet/feed/",transformer:function(e){var t=e.data||{},n=t.widgets,o=t.pager;return{posts:(null==n?void 0:n.map(function(e){var t,n,o,s,i,r,a,l,u,c,d,p,m,f,h,v,x,g,_,C,j,N;return i=(s=({data:e.data}).data||{}).id,r=s.title,a=s.caption,l=s.author,u=s.media,c=s.products,d=s.share_urls,p=s.likes_count,m=s.comments_count,f=s.created_at,h=s.tags,v=s.is_user_own_post,x=s.user_reaction,g=s.likes,_=s.circle_cover,C=s.friends_like,j=s.bold_text,N=s.light_text,{postId:i,postTitle:r,postCaption:a,postAuthor:(0,J.U)({data:l}),postProducts:null==c?void 0:c.map(function(e){var t;return t=(0,z.r)({data:e}),(0,R.Z)((0,M.Z)({},t),{productPrice:(0,F.z)({data:e.price})})}),postShareUrls:(0,D.r)({data:d}),postLikesCount:p,postMedia:null==u?void 0:u.map(function(e){return(0,V.n)({data:e})}),postCommentsCount:m,postCreatedAt:f,postTags:null==h?void 0:h.map(function(e){return(0,q.p)({data:e})}),postIsUserOwnPost:v,postUserReaction:(n=(t=x||{}).liked,o=t.saved,{isLiked:Boolean(n),isSaved:Boolean(o)}),postLikes:null==g?void 0:g.map(function(e){return(0,H.s)({data:e})}),postCircleCover:(0,B.W)({data:_}),friendsLike:C,friendsNameLikePost:j,friendsLikeText:N}}))||[],pager:(0,L.d)({data:o})}}}),G=n(95391),K=n(72677),Q=n(14433),Y=n(58013),W=n(77251),$=n(57033),ee=n(24753),et=(0,w.q)({url:function(e){var t=e.postId;return"magnet/posts/".concat(t,"/likes/")},transformer:ee.q}),en=n(87225),eo=n(25127),es=n.n(eo);function ei(e){var t=e.user,n=e.followingUserName,s=t||{},a=s.username,l=s.photo,u=s.isFollowing;return(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(r.r,{to:(0,c.kK)(a),"data-testid":"user-photo-profile",children:(0,o.jsx)(i.E,{className:"shrink-0",imageClassName:"rounded-circle",src:x.C,image:l,height:50,width:50})}),(0,o.jsxs)("div",{className:"flex w-full justify-between items-center mr-1 py-3",children:[(0,o.jsx)(r.r,{"data-testId":"profile",to:(0,c.kK)(a),className:"mr-2 cursor-pointer","data-testid":"user-name-profile",children:(0,o.jsx)("div",{className:"text-body2-strong text-neutral-800",children:a})}),(n!==a||!u)&&(0,o.jsx)(en.n,{"data-testid":"follow-unfollow-button",className:es().followUnfollowButton,isFollowing:u,username:a,isNotFollowLabel:"دنبال کردن",isFollowShape:"text",isNotFollowShape:"icon",hasColor:!0})]})]})}function er(e){var t=e.postId,n=e.followingUserName,s=(0,T.a)({apiMethod:et,apiData:{postId:t}}),i=s.data,r=s.fetchPage,a=s.pending,l=s.items,u=(i||{}).pager,c=(0,E.useMemo)(function(){return Object.entries(l||{}).filter(function(e){var t=(0,U.Z)(e,2)[1];return!(0,A.x)(t)}).flatMap(function(e){var t=(0,U.Z)(e,2);return(t[0],t[1]).users||[]})},[l,null==u?void 0:u.pagerCurrentPage]),d=(0,E.useMemo)(function(){return function(e){var t=(0,Y.Z)({},(0,W.Z)(e));return(0,o.jsx)(ei,{user:t,followingUserName:n})}},[]);return(0,o.jsx)(o.Fragment,{children:a&&(0,A.x)(c)?(0,o.jsx)(_.g,{className:"my-20"}):(0,o.jsx)($.S,{hidePagination:!0,itemComponent:d,fetchPage:r,pager:u,itemsPerRow:1,items:c,itemHasBorder:!1})})}function ea(e){var t=e.isOpen,n=e.onCancel,i=e.title,r=e.postId,a=e.followingUserName;return(0,o.jsx)("div",{onTouchEnd:function(e){e.stopPropagation()},children:(0,o.jsx)(C.Modal,{isOpen:t,className:"flex justify-center items-center",onDismiss:n,headerTitle:i,hasCloseIcon:!1,headerClassName:"d-none",headerHideBottomBorder:!0,header:(0,o.jsxs)("div",{className:"flex items-center justify-start p-4",children:[(0,o.jsx)(s.J,{icon:"arrowRight",size:24,onClick:n}),(0,o.jsx)("div",{className:"text-h4 text-neutral-800 mr-5",children:"پسندیده‌ها"})]}),children:(0,o.jsx)("div",{className:"h-full","data-testid":"list-of-likes",children:(0,o.jsx)(er,{postId:r,followingUserName:a})})})})}function el(e){var t,n=e.post,s=e.className,r=e.containerClassName,a=e.followingUserName,l=(0,p.d)(),u=l.isOpen,c=l.onOpen,d=l.onClose;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:(0,K.d)("flex items-center justify-start pr-5",r),onClick:c,children:[(0,o.jsx)("div",{className:"flex justify-between items-center relative",children:null==n?void 0:null===(t=n.friendsLike)||void 0===t?void 0:t.slice(0,2).map(function(e,t){return(0,o.jsx)(i.E,{width:20,height:20,className:(0,K.d)("shrink-0 ml-2",1===t&&"absolute right-3"),imageClassName:"rounded-circle",src:e.photo?e.photo:Q.Cb,alt:e.name})})}),(0,o.jsx)("div",{className:"mr-2",children:(0,o.jsxs)("span",{className:(0,K.d)("text-neutral-650 text-body2-strong",s),children:[null==n?void 0:n.friendsNameLikePost," ",(0,o.jsx)("span",{className:(0,K.d)("text-neutral-500 text-body-1",s),children:null==n?void 0:n.friendsLikeText})]})})]}),u&&(0,o.jsx)(ea,{isOpen:u,onCancel:d,postId:n.postId,followingUserName:a})]})}var eu=n(62075),ec=n(47715),ed=n(51207),ep=n(50930),em=n(32e3),ef=n.n(em),eh=n(18577),ev=function(){return(0,o.jsx)("div",{className:"p-4",children:(0,ep.Z)([,,,,,]).map(function(e,t){return(0,o.jsxs)("div",{className:(0,eh.dh)("mb-6 rounded-md",ef().postSkeleton),children:[(0,o.jsxs)("div",{className:"flex items-center py-2 px-4",children:[(0,o.jsx)("div",{className:(0,eh.dh)(ef().avatarSkeleton,"ml-2")}),(0,o.jsx)("div",{className:(0,eh.dh)(ef().usernameSkeleton,"ml-3 rounded-md")})]}),(0,o.jsx)("div",{className:ef().imageSkeleton}),(0,o.jsxs)("div",{className:(0,eh.dh)(ef().contentSkeleton,"p-4"),children:[(0,o.jsx)("div",{}),(0,o.jsx)("div",{}),(0,o.jsx)("div",{})]})]},t)})})},ex=n(98788),eg=n(47842),e_=n(5163),eC=n(79593),ej=n(37149),eN=n.n(ej),ek=n(64177),eI=n(15585),ew=(0,E.createContext)(void 0);function ey(e){var t=e.children,n=(0,U.Z)((0,E.useState)(!1),2),s=n[0],i=n[1];return(0,o.jsx)(ew.Provider,{value:{isMute:s,toggleMute:function(){return i(function(e){return!e})}},children:t})}var eb=n(61538),eS=n(371),eO=n(98634),eP=n(86671),eM=n(7208),eU=n(57955),eE=n.n(eU);function eT(e){var t=e.className,n=e.postMedia,i=e.playerRef,r=e.isPlaying,a=e.mediaUrl,l=e.isMute,u=e.OnClick,c=e.onVideoTimerUpdate,d=(n||{}).postMediaUrl,p=(0,U.Z)((0,E.useState)({duration:0,playedSeconds:0,playedPercent:0}),2),m=p[0],f=p[1],h=(0,U.Z)((0,E.useState)(l),2),v=h[0],x=h[1];return(0,E.useEffect)(function(){if(l){x(!0);var e=setTimeout(function(){return x(!1)},3e3);return function(){return clearTimeout(e)}}},[l]),(0,o.jsxs)("div",{className:(0,K.d)(t,"relative"),onClick:u,children:[(0,o.jsx)(_.g,{className:"absolute inset-0 mx-auto my-auto z-[-1]"}),(0,o.jsx)("div",{className:(0,K.d)("absolute w-full h-full z-[20]",eE().overlay)}),(0,o.jsxs)("div",{className:"absolute w-full h-full z-[10]",children:[(0,o.jsx)(eM.Y,{url:d||a,height:"100%",width:"100%",ref:i,playing:r,muted:l,loop:!0,onDuration:function(e){var t=(0,R.Z)((0,M.Z)({},m),{duration:Math.floor(e)});f(t),c(t)},onProgress:function(e){var t=e.playedSeconds,n=e.played,o=(0,R.Z)((0,M.Z)({},m),{playedSeconds:t,playedPercent:Math.floor(100*n)});f(o),c(o),n>=.997&&setTimeout(function(){n>=.997&&i.current.seekTo(0,"seconds")},1e3)},style:{pointerEvents:"none",zIndex:"10"}}),l&&v&&(0,o.jsx)(s.J,{color:"white",icon:"speakerMuted",className:"absolute right-0 left-0 top-0 bottom-0 m-auto w-max h-max z-[25]",size:75})]})]})}var eZ=n(842),eA=n(29078),eL=n.n(eA);function eR(e){var t,n,s,r,a=e.className,l=e.videoOnDoubleClick,u=e.preventClicks,c=e.preventClicksPropagation,d=e.simulateTouch,p=e.post,m=e.activePostIndex,f=(0,ek.C)().isDesktop,h=(0,U.Z)((0,E.useState)(0),2),v=h[0],x=h[1],_=(0,U.Z)((0,E.useState)(null),2),C=_[0],j=_[1],N=(0,U.Z)((0,E.useState)({}),2),k=N[0],I=N[1],w=(0,E.useRef)([]),y=(null==p?void 0:null===(t=p.postMedia)||void 0===t?void 0:t.length)===1,b=(null===(n=p.postMedia)||void 0===n?void 0:null===(s=n[v])||void 0===s?void 0:s.postMediaType)==="video",S=function(e,t){I(function(n){return(0,R.Z)((0,M.Z)({},n),(0,eg.Z)({},e,t))})},O=function(){var e=(0,E.useContext)(ew);if(!e)throw Error("useMute must be used within a MuteProvider");return e}(),P=O.isMute,T=O.toggleMute,Z=function(){T()},A=function(){if(C){var e;clearTimeout(C),j(null),l(),(0,eu.He)({postId:null==p?void 0:p.postId,authorId:null==p?void 0:null===(e=p.postAuthor)||void 0===e?void 0:e.authorId,placeIndex:m})}else{var t=setTimeout(function(){Z(),j(null)},300);j(t)}};(0,E.useEffect)(function(){return function(){C&&clearTimeout(C)}},[C]),(0,E.useEffect)(function(){setTimeout(function(){w.current&&w.current.forEach(function(e,t){e&&(t===v&&b?e.getInternalPlayer()&&e.getInternalPlayer().play():e.getInternalPlayer().pause())})},400)},[v,b,w]);var L=(0,E.useCallback)((0,eO.Ds)(function(e){var t=e.value;w.current.forEach(function(e,n){n===v&&e.seekTo(t[0]/100,"fraction")})},300),[v]),B=function(){w.current&&w.current[v].getInternalPlayer().play()},F=function(){(null==w?void 0:w.current)&&(null==w||w.current[v].getInternalPlayer().play())};return(0,o.jsx)("div",{className:(0,K.d)("relative h-full",a),children:(0,o.jsx)(eP.i,{preventClicks:u,preventClicksPropagation:c,simulateTouch:d,onSlideChange:function(e){x(e.activeIndex)},initialSlide:0,slidesPerView:1,spaceBetween:8,hasPagination:f,className:"h-full",sliderContainerClassName:(0,K.d)("h-full",eL().sliderContainer),slideClassName:"h-screen",navigationButtonClassName:{prev:"hidden hidden",next:"hidden hidden"},pagination:{clickable:!0,clickableClass:(0,K.d)(y?"d-none":eL().pagination),bulletClass:(0,K.d)(y?"d-none":"inline-block rounded-circle mx-1 bg-neutral-900",y?"d-none":eL().slider__pagination),bulletActiveClass:(0,K.d)(y?"d-none":eL()["slider__pagination--active"])},slidesPerGroup:1,slides:null==p?void 0:null===(r=p.postMedia)||void 0===r?void 0:r.map(function(e,t){switch(e.postMediaType){case"image":return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:(0,K.d)("absolute w-full h-full z-[20]",eL().overlay),onClick:A}),(0,o.jsx)(i.E,{imageClassName:"w-full h-screen z-[10]",src:e.postMediaUrl},e.postMediaId)]});case"video":return(0,o.jsxs)("div",{className:"relative h-full",children:[(0,o.jsx)(eT,{className:"w-full h-full",mediaUrl:e.postMediaUrl,playerRef:function(e){return w.current[t]=e},OnClick:A,isMute:P,onVideoTimerUpdate:function(e){return S(t,e)}}),(0,o.jsx)(eZ.Q,{onChange:L,videoTimer:k[t]||{duration:0,playedSeconds:0,playedPercent:0},onTouchMove:B,onTouchEnd:F,className:(0,K.d)("px-2 absolute z-20","iOS"===g.BF?"bottom-7":"bottom-5",eL().progressBar)})]},e.postMediaId);default:return(0,o.jsx)("div",{className:"ratio-1-1 flex items-center justify-center",children:"Unsupported media type"},t)}})})})}var eB=n(51383),eF=n(96879),ez=n(84714),eD=n(78631),eJ=n.n(eD),eV={isLiked:{iconColor:"primary",iconName:"favoriteOn"},isDisliked:{iconColor:"white",iconName:"favoriteOff"}},eq=(0,E.forwardRef)(function(e,t){var n=e.className,i=e.post,r=e.postReaction,a=e.isOpenCommentModal,l=e.onOpenCommentModal,u=e.onCloseCommentModal,c=e.onSuccessLike,d=e.activePostIndex,m=(0,p.d)(),f=m.onOpen,h=m.isOpen,x=m.onClose,_=i||{},C=_.postCommentsCount,j=_.postId,N=_.postAuthor,k=(0,ez.g)((0,R.Z)((0,M.Z)({},i),{postUserReaction:{isLiked:null==r?void 0:r.isPostLiked}}),c),I=k.handleLikePost,w=k.isLiked,y=k.likesCount,b=w?eV.isLiked:eV.isDisliked,S=function(){I(),(0,eu.He)({postId:j,authorId:null==N?void 0:N.authorId,placeIndex:d})},P=function(){(0,eu.ac)({postAuthorId:null==N?void 0:N.authorId,postId:j}),(0,v.p)({message:"برای استفاده از امکانات کامل از اپلیکیشن استفاده کنید.",actionText:"دریافت اپلیکیشن",actionFunction:function(){f(),(0,eu.WO)()}})};return(0,E.useImperativeHandle)(t,function(){return{sendLikePost:S}}),(0,o.jsxs)("div",{className:(0,K.d)(n,"flex gap-3 flex-col items-center"),children:[(0,o.jsx)(eB.P,{children:(0,o.jsxs)("span",{className:"cursor-pointer text-white flex flex-col items-center text-body-strong",onClick:S,"data-testid":"like-icon",children:[(0,o.jsx)(s.J,{color:b.iconColor,size:24,icon:b.iconName}),y>0&&(0,o.jsx)(eF.I,{value:y})]})}),(0,o.jsxs)("span",{className:"cursor-pointer text-white flex flex-col items-center text-body-strong","data-testid":"comment-icon",children:[(0,o.jsx)(s.J,{color:"white",size:24,icon:"comment",onClick:function(){l(),(0,eu.HT)({postAuthorId:null==N?void 0:N.authorId,postId:j})}}),C>0&&(0,o.jsx)(eF.I,{value:C})]}),(0,o.jsx)("span",{"data-testid":"save-icon",className:"cursor-pointer flex items-center text-button-1 user-select-none",onClick:P,children:(0,o.jsx)(s.J,{color:"white",size:24,icon:"favOff"})}),(0,o.jsx)(ec.r,(0,M.Z)({post:i,isOpen:a,onClose:u,hasCloseIcon:!0,commentItemClassName:eJ().commentItem,headerHideBottomBorder:!0,commentItemContainerClassName:eJ().commentItem,modalClassName:eJ().modal},"iOS"!==g.BF&&{inputOnClick:P},"iOS"!==g.BF&&{inputDisabled:!0})),(0,o.jsx)(O,{onClose:x,isOpen:h})]})}),eH=n(5046);function eX(e){var t=e.className,n=e.post;return(0,o.jsx)("div",{className:(0,K.d)(t,"relative h-full"),children:(0,o.jsx)(eH.l,{shouldDisplayShowMore:!1,titleColor:"text-neutral-100",captionColor:"text-neutral-100",post:n})})}var eG=n(66524),eK=n(92428),eQ=n(36155),eY=n(14052),eW=n(52483),e$=n(42729),e0=n(45227),e2=(0,w.q)({url:"magnet/affiliate/",type:e0.XN.POST,inputTransformer:function(e){return{post_id:e.postId,product_id:e.productId}}}),e1=n(5257),e7=n.n(e1);function e5(e){var t,n,s=e.className,i=e.products,r=e.postId,a=e.postAuthorId;i.length;var l=(0,eG.R)({modalId:e$.f.VIDEO_BABY_PDP}),u=l.isOpen,c=l.onClose,d=l.onOpen,p=(0,U.Z)((0,E.useState)({productId:null,product:null}),2),m=p[0],f=p[1],h=(0,N.E)({apiMethod:eQ.z,onSuccess:function(e){var t=e.product;f(function(e){return(0,R.Z)((0,M.Z)({},e),{product:t})}),d()}}),v=h.request,x=h.pending,g=(0,N.E)({apiMethod:e2}).request,_=(0,E.useRef)(null),C=!1;return(0,A.x)(i)?null:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:(0,K.d)(s,"flex gap-2 overflow-x-auto  hide-scrollbar p-2"),onMouseDown:function(e){C=!0,t=e.pageX-_.current.offsetLeft,n=_.current.scrollLeft},onMouseLeave:function(e){C=!1},onMouseUp:function(e){C=!1},onMouseMove:function(e){if(C){e.preventDefault(),e.stopPropagation();var o=e.pageX-_.current.offsetLeft;_.current.scrollLeft=n-(o-t)*3}},ref:_,children:i.map(function(e,t){var n;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(eY.z,{loading:x&&e.productId===m.productId,className:(0,K.d)("ml-2 lg:ml-0 select-none h-[50px]",e7().productBackground),onClick:(n=e.productId,function(){f(function(e){return(0,R.Z)((0,M.Z)({},e),{productId:n})}),v({productId:n}),g({productId:n,postId:r}),(0,eu.H9)({productId:n,postId:r,placeIndex:t,authorId:a})}),productImage:e.productImage,productTitle:e.productTitle,productPrice:e.productPrice,height:46,width:46},e.productId)})})}),m.product&&(0,o.jsx)(eW.J,{onAddToCart:function(e){(0,eu.q_)({productId:e,postId:r,postAuthorId:a})},onShowMoreClicked:function(e){(0,eu.dE)({productId:e,postId:r,postAuthorId:a})},isOpenModal:u,closeModal:function(){f({product:null,productId:null}),c()},product:m.product,type:eK.J.MAGNET_LIVE})]})}var e3=n(27525),e4=n.n(e3),e6=function(){return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s.J,{"data-testid":"like",size:100,color:"error",icon:"favoriteOn",className:(0,K.d)("z-2 absolute",e4().like)})})},e8=n(6726),e9=n(48607),te=n(26514),tt=n.n(te);function tn(e){var t,n,s,r,a,l,u=e.className,d=e.post,p=e.postReaction,m=e.onCloseVideoModal,f=e.toPreviousPost,h=e.toNextPost,v=e.updateLikeReaction,_=e.updateAuthorFollowedReaction,C=e.isEndOfReels,j=e.activePostIndex,N=(0,E.useRef)(null),k=(0,E.useRef)(null),I=(0,eb.d)(),w=I.isOpen,y=I.onOpen,b=I.onClose,S=(0,U.Z)((0,E.useState)(!1),2),O=S[0],P=S[1],M=(0,e9.Y)({onSwipedUp:!w&&h,onSwipedDown:!w&&f,onSwipedLeft:function(){},onSwipedRight:function(){}}),T=M.onTouchStart,Z=M.onTouchMove,A=M.onTouchEnd,L=(0,eO.P2)(function(){P(!0),N.current&&N.current.sendLikePost(),setTimeout(function(){return P(!1)},2e3)},300),R=(0,E.useCallback)(function(){return(0,E.useMemo)(function(){return(0,o.jsxs)("div",{className:(0,K.d)("w-full h-full relative"),children:[(0,o.jsx)(eS.x,{className:"absolute right-5 top-8 z-2",color:"white",onClick:m}),(0,o.jsx)(eR,{playerRef:k,post:d,videoOnDoubleClick:L,activePostIndex:j})]})},[null==d?void 0:d.postId])},[null==d?void 0:d.postId]);return C&&"iOS"!==g.BF?(0,o.jsxs)("div",{className:(0,K.d)("custom-content-container h-full flex flex-col items-center justify-center px-3",tt().endOfReelsContainer),onTouchStart:T,onTouchMove:Z,onTouchEnd:A,children:[(0,o.jsx)(eS.x,{className:"absolute right-5 top-8 z-2",color:"white",onClick:m}),(0,o.jsx)(i.E,{src:"/statics/img/png/magnet/magnet-arrow.png",alt:"magnet-arrow",width:66,height:66,className:"mb-4"}),(0,o.jsx)("p",{className:"text-white text-h5",children:"دسترسی به هزاران ویدیو نقد و بررسی"}),(0,o.jsxs)("p",{className:"text-body-1 text-neutral-200 text-center mt-2",children:["برای تماشای بیشتر ویدیو‌های مگنت،‌ اپلیکیشن ",(0,o.jsx)("br",{}),"دیجی‌کالا را دریافت کنید."]}),(0,o.jsx)(e8.J,{buttonClassName:tt().button,className:tt().installApp,onDataTracker:eu.I8}),(0,o.jsx)("div",{className:(0,K.d)(tt().animationImage,"mt-12")})]}):(0,o.jsxs)("div",{className:(0,K.d)(u,"w-full h-full flex flex-col"),onTouchStart:T,onTouchMove:Z,onTouchEnd:A,children:[(0,o.jsxs)("div",{className:(0,K.d)("flex flex-col justify-between absolute w-full z-2","iOS"===g.BF?"bottom-[13%]":"bottom-[10%]"),children:[(0,o.jsxs)("div",{className:"flex items-end gap-1 justify-between px-5 mb-4",children:[(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsxs)("section",{className:(0,K.d)("flex items-center justify-start"),children:[(0,o.jsxs)("a",{className:"flex items-center",href:(0,c.kK)(null==d?void 0:null===(t=d.postAuthor)||void 0===t?void 0:t.authorUsername),"data-testid":"user-photo-profile",children:[(0,o.jsx)(i.E,{className:"shrink-0",imageClassName:"rounded-circle",image:null==d?void 0:null===(n=d.postAuthor)||void 0===n?void 0:n.authorPhoto,src:x.C,height:40,width:40}),(0,o.jsxs)("div",{className:"mr-2 ml-4",children:[(0,o.jsx)("p",{className:"text-h5 text-neutral-100",children:null==d?void 0:null===(s=d.postAuthor)||void 0===s?void 0:s.authorName}),(0,o.jsxs)("p",{className:"text-caption text-neutral-100",children:[null==d?void 0:null===(r=d.postAuthor)||void 0===r?void 0:r.authorUsername,"@"]})]})]}),(0,o.jsx)(eB.P,{children:(0,o.jsx)(en.n,{"data-testid":"follow-unfollow-button",isFollowing:null==p?void 0:p.isAuthorFollowed,isFollowShape:"text",isNotFollowShape:"outlined",username:null==d?void 0:null===(a=d.postAuthor)||void 0===a?void 0:a.authorUsername,color:"white",size:"small",className:"h-7",onSuccess:_,onDataTracker:function(){var e,t;return(0,eu.gb)({postAuthorId:null==d?void 0:null===(e=d.postAuthor)||void 0===e?void 0:e.authorId,postId:null==d?void 0:d.postId,followingUserName:null==d?void 0:null===(t=d.postAuthor)||void 0===t?void 0:t.authorUsername})}})})]}),(0,o.jsx)(eX,{className:"mt-3",post:d}),(0,o.jsx)(el,{post:d,className:tt().likeText,containerClassName:tt().likeContainer,"data-testid":"show-likes"})]}),(0,o.jsx)(eq,{ref:N,post:d,postReaction:p,isOpenCommentModal:w,onOpenCommentModal:y,onCloseCommentModal:b,onSuccessLike:v,activePostIndex:j})]}),(0,o.jsx)(e5,{className:"shrink-0 grow-0 ",postId:null==d?void 0:d.postId,postAuthorId:null==d?void 0:null===(l=d.postAuthor)||void 0===l?void 0:l.authorId,products:null==d?void 0:d.postProducts})]}),(0,o.jsx)(R,{}),O&&(0,o.jsx)(e6,{})]})}function to(e){return(0,o.jsx)(ey,{children:(0,o.jsx)(tn,(0,M.Z)({},e))})}var ts={overlay:{zIndex:4}};function ti(e){var t=e.post,n=e.postReaction,s=e.isOpen,i=e.onClose,r=e.toNextPost,a=e.toPreviousPost,l=e.onVideoEnded,u=e.updateLikeReaction,c=e.updateAuthorFollowedReaction,d=e.isEndOfReels,p=e.hasPreviousPost,m=e.activePostIndex,f=e.followingUserName,h=(0,ek.C)().isDesktop,v=t||{},x=v.postId,g=v.postAuthor,_=(0,E.useRef)(window.innerHeight);(0,eI.N)({condition:s}),(0,E.useEffect)(function(){s&&(0,eu._H)({postId:x,postAuthorId:null==g?void 0:g.authorId})},[s]);var C=function(){(0,eu.Yk)({postId:x,postAuthorId:null==g?void 0:g.authorId}),i()};return(0,o.jsx)(eN(),{isOpen:s,shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!0,onRequestClose:C,className:(0,K.d)("relative w-fit lg:px-20 mx-auto bg-black flex justify-center items-center flex-row z-[2000]"),style:ts,children:(0,o.jsx)("div",{className:"grow-0 lg:w-90 w-screen relative",style:h?{height:_.current>760?"720px":"".concat(.95*_.current,"px")}:{height:"".concat(_.current,"px")},children:(0,o.jsx)(to,{activePostIndex:m,onCloseVideoModal:C,onVideoEnded:l,post:t,postReaction:n,toNextPost:r,toPreviousPost:a,updateLikeReaction:u,updateAuthorFollowedReaction:c,isEndOfReels:d,hasPreviousPost:p,followingUserName:f})})})}function tr(e){var t=e.isOpenVideoModal,n=e.onCloseVideoModal,s=e.postClicked,i=e.followingUserName;if(!s)return console.error("No initial reel post found in localStorage."),null;var r=(0,E.useRef)(!1),a=(0,U.Z)((0,E.useState)([s]),2),l=a[0],u=a[1],c=(0,U.Z)((0,E.useState)(0),2),d=c[0],p=c[1],m=l[d],f=(m||{}).postId,h=(0,U.Z)((0,E.useState)({}),2),v=h[0],x=h[1],C=(0,N.E)({apiMethod:X,onSuccess:function(e){var t=(Array.isArray(e.posts)?e.posts:[]).filter(function(e){return e.postId!==s.postId}),n="iOS"===g.BF?t:(0,ep.Z)(t.slice(0,9)).concat([{isSpecialItem:!0}]);u(function(e){return(0,ep.Z)(e).concat((0,ep.Z)(n))}),r.current=!0}}),j=C.request,k=C.pending;(0,E.useEffect)(function(){var e,n=(e=(0,ex.Z)(function(){return(0,e_.__generator)(this,function(e){switch(e.label){case 0:if(r.current)return[3,2];return[4,j()];case 1:e.sent(),e.label=2;case 2:return[2]}})}),function(){return e.apply(this,arguments)});t&&n()},[t,j]),(0,E.useEffect)(function(){m&&!m.isSpecialItem&&x(function(e){var t,n;return(0,R.Z)((0,M.Z)({},e),(0,eg.Z)({},f,e[f]||{isPostLiked:null==m?void 0:null===(t=m.postUserReaction)||void 0===t?void 0:t.isLiked,isAuthorFollowed:null==m?void 0:null===(n=m.postAuthor)||void 0===n?void 0:n.authorIsFollowing}))})},[m,f]),(0,E.useEffect)(function(){try{var e=JSON.parse(localStorage.getItem("".concat(f)));e&&x(function(t){return(0,R.Z)((0,M.Z)({},t),(0,eg.Z)({},f,(0,R.Z)((0,M.Z)({},t[f]),{isPostLiked:e.isLiked})))})}catch(t){console.log(t)}},[]);var I=0!==d||m.isSpecialItem,w=d<l.length-1;return k&&l.length>1?(0,o.jsx)(_.g,{}):(0,A.x)(l)||eC.s||!m?null:(0,o.jsx)(ti,{followingUserName:i,activePostIndex:d,toNextPost:function(){w&&p(function(e){return e+1})},toPreviousPost:function(){I&&p(function(e){return e-1})},hasNextPost:w,isEndOfReels:m.isSpecialItem,hasPreviousPost:I,post:m.isSpecialItem?null:m,postReaction:v[f],isOpen:t,onClose:function(){p(0),n()},onVideoEnded:function(){return""},updateLikeReaction:function(e){x(function(t){var n=new CustomEvent("".concat(f),{detail:{isLiked:e}});return document.dispatchEvent(n),(0,R.Z)((0,M.Z)({},t),(0,eg.Z)({},f,(0,R.Z)((0,M.Z)({},t[f]),{isPostLiked:e})))})},updateAuthorFollowedReaction:function(e){return x(function(t){return(0,R.Z)((0,M.Z)({},t),(0,eg.Z)({},f,(0,R.Z)((0,M.Z)({},t[f]),{isAuthorFollowed:e})))})}})}var ta=n(47792),tl=n(28147),tu=n(67090),tc=n.n(tu),td={isLiked:{iconColor:"primary",iconName:"favoriteOn"},isDisliked:{iconColor:"high-emphasis",iconName:"favoriteOff"}};function tp(e){var t=e.isLiked,n=e.setIsLiked,i=e.post,r=e.handlePost,a=e.onOpenCommentModal,l=e.postIndex,u=t?td.isLiked:td.isDisliked,c=(0,p.d)(),d=c.onOpen,m=c.isOpen,f=c.onClose,h=(0,N.E)({apiMethod:ta.m}).request;return(0,E.useEffect)(function(){n(i.postUserReaction.isLiked),localStorage.setItem("".concat(i.postId),JSON.stringify({isLiked:i.postUserReaction.isLiked}))},[i.postUserReaction.isLiked]),(0,o.jsxs)("div",{className:"flex items-center justify-between text-neutral-650 px-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-start select-none focus:outline-none",children:[(0,o.jsx)("div",{"data-testid":"like-icon",className:(0,K.d)("flex items-center text-button-1 ml-3",tc().noSelect),onClick:function(){(0,eu.KD)({authorId:null==i?void 0:i.postAuthor.authorId,postId:null==i?void 0:i.postId,placeIndex:l}),h({postId:i.postId}).then(function(){n(function(e){return localStorage.setItem("".concat(i.postId),JSON.stringify({isLiked:!e})),!e})})},children:(0,o.jsx)(s.J,{size:24,color:null==u?void 0:u.iconColor,icon:null==u?void 0:u.iconName})}),(0,o.jsxs)("span",{"data-testid":"comment-icon",className:"flex items-center text-button-1 ml-3",onClick:function(){var e;r(i),a(),(0,eu.xy)({postAuthorId:null==i?void 0:null===(e=i.postAuthor)||void 0===e?void 0:e.authorId,postId:null==i?void 0:i.postId})},children:[(0,o.jsx)(s.J,{className:"mr-1",color:"high-emphasis",size:24,icon:"comment"}),i.postCommentsCount>0&&(0,o.jsx)("span",{className:"text-icon-high-emphasis mr-1",children:(0,Z.U)(i.postCommentsCount)})]}),(0,o.jsx)("span",{"data-testid":"share-icon",className:"cursor-pointer flex items-center text-button-1",children:(0,o.jsx)(tl.z,{shareUrls:i.postShareUrls,iconColor:"high-emphasis",shareMessage:"این پروفایل رو با دوستان خود به اشتراک بگذارید.",telegramClassName:tc().shareContainer,whatsappClassName:tc().shareContainer,smsClassName:tc().shareContainer,copyBtnClassName:tc().shareContainer,twitterClassName:tc().shareContainer,shareMessageClassName:"text-center",icon:"cube-action-share",onDataTracker:function(){var e;return(0,eu.BK)({postAuthorId:null==i?void 0:null===(e=i.postAuthor)||void 0===e?void 0:e.authorId,postId:null==i?void 0:i.postId})}})})]}),(0,o.jsx)("span",{"data-testid":"save-icon",className:"cursor-pointer flex items-center text-button-1 user-select-none",onClick:function(){var e;(0,eu.e$)({postAuthorId:null==i?void 0:null===(e=i.postAuthor)||void 0===e?void 0:e.authorId,postId:null==i?void 0:i.postId}),(0,v.p)({message:"برای استفاده از امکانات کامل از اپلیکیشن استفاده کنید.",actionText:"دریافت اپلیکیشن",actionFunction:function(){d(),(0,eu.WO)()}})},children:(0,o.jsx)(s.J,{size:24,icon:"favOff"})}),(0,o.jsx)(O,{onClose:f,isOpen:m})]})}var tm=n(23568),tf=n(89618),th=n.n(tf),tv=(0,E.memo)(function(e){var t=e.post,n=e.setIsLiked,s=e.onMediaClicked,i=e.onVideoRefUpdate,r=e.postIndex,a=1===t.postMedia.length,l=(0,U.Z)((0,E.useState)(!1),2),u=l[0],c=l[1],d=(0,U.Z)((0,E.useState)(0),2),p=d[0],m=d[1],f=(0,E.useRef)([]),h=(0,E.useRef)(null),v=function(e,t){m(t)},x=(0,N.E)({apiMethod:ta.m}).request,g=function(){f.current.forEach(function(e,t){e&&(t===p?e.play():e.pause())})};(0,E.useEffect)(function(){var e=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target===h.current?g():f.current.forEach(function(e){return null==e?void 0:e.pause()})})},{threshold:.01});return h.current&&e.observe(h.current),function(){h.current&&e.unobserve(h.current)}},[p]);var _=(0,eO.P2)(function(){c(!0),n(function(e){return localStorage.setItem("".concat(t.postId),JSON.stringify({isLiked:!e})),!e}),x({postId:t.postId}).catch(function(){c(!0)}),(0,eu.KD)({authorId:null==t?void 0:t.postAuthor.authorId,postId:null==t?void 0:t.postId,placeIndex:r}),setTimeout(function(){return c(!1)},2e3)},300),C=(0,E.useCallback)(function(){return(0,E.useMemo)(function(){return(0,o.jsx)("div",{className:(0,K.d)("w-full relative"),children:(0,o.jsx)(tm.F,{postMedia:t.postMedia,handleCurrentSlideVideo:v,videoRefs:f,videoClassName:th().videoContainer,videoOnDoubleClick:_,videoOnClick:s,hasSpeakerButton:!0,showSlideNumber:!1,hasAutoPlay:!1,onVideoRefUpdate:i,navigationButtonClassName:{prev:"hidden hidden",next:"hidden hidden"},sliderContainerClassName:th().sliderContainer,pagination:{clickable:!0,clickableClass:th().clickableClass,bulletClass:(0,K.d)(a?"d-none":"inline-block rounded-circle mx-1 bg-neutral-900",(0,eg.Z)({},th().slider__pagination,!a)),bulletActiveClass:(0,K.d)(a?"d-none":th()["slider__pagination--active"])}})})},[null==t?void 0:t.postId])},[null==t?void 0:t.postId]);return(0,o.jsxs)("div",{ref:h,className:(0,K.d)("flex mb-2 relative",th().mainContainer),children:[(0,o.jsx)(C,{}),u&&(0,o.jsx)(e6,{})]})});function tx(e){var t=e.post,n=e.handlePost,s=e.onOpenCommentModal,i=e.postIndex,r=e.followingUserName,a=(0,U.Z)((0,E.useState)(!1),2),l=a[0],u=a[1],c=(0,U.Z)((0,E.useState)(null),2),d=c[0],p=c[1],m=(0,U.Z)((0,E.useState)(),2),f=m[0],h=m[1],v=(0,eG.R)({modalId:e$.f.VIDEO}),x=v.isOpen,g=v.onOpen,_=v.onClose,C=function(e){p(e),g(),(0,eu.uN)({postAuthorId:null==t?void 0:t.postAuthor.authorId,postId:null==t?void 0:t.postId})};return(0,E.useEffect)(function(){x&&f&&f.pause()},[x]),(0,E.useEffect)(function(){var e=function(e){u(e.detail.isLiked)};return document.addEventListener("".concat(t.postId),e),function(){return document.removeEventListener("".concat(t.postId),e)}},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tv,{post:t,setIsLiked:u,onMediaClicked:function(){return C(t)},onVideoRefUpdate:function(e,t){h(e.current[t])},postIndex:i}),(0,o.jsx)(tp,{isLiked:l,post:t,setIsLiked:u,handlePost:n,onOpenCommentModal:s,postIndex:i}),d&&(0,o.jsx)(tr,{isOpenVideoModal:x,postClicked:d,onCloseVideoModal:function(){p(null),_()},followingUserName:r})]})}var tg=function(e){var t=e.postCaption,n=e.maxLength,s=void 0===n?100:n,i=e.postTitle,r=(0,U.Z)((0,E.useState)(!1),2),a=r[0],l=r[1],u=(null==t?void 0:t.length)>s?(null==t?void 0:t.slice(0,s))+"...":t;return(0,o.jsxs)("div",{className:"px-5",children:[i&&(0,o.jsx)("p",{className:"text-neutral-800 text-subtitle-strong mt-3 mb-1",children:i}),(0,o.jsxs)("p",{className:"text-body-1 text-neutral-700",children:[a?t:u,(null==t?void 0:t.length)>s&&(0,o.jsx)("span",{className:"cursor-pointer text-blue-700",onClick:function(){l(!a)},children:!a&&"ادامه"})]})]})},t_=n(20096),tC=n.n(t_);function tj(){return(0,o.jsxs)("div",{className:(0,K.d)(tC().imageBackground,"flex flex-col items-center justify-center"),children:[(0,o.jsx)(i.E,{src:"/statics/img/png/magnet/magnet-arrow.png",alt:"magnet-arrow",width:56,height:56}),(0,o.jsx)("p",{className:"text-neutral-850 text-h5",children:"دسترسی به هزاران ویدیو نقد و بررسی"}),(0,o.jsxs)("p",{className:"text-body-1 text-neutral-650 text-center",children:["برای استفاده از امکانات مگنت،‌ اپلیکیشن دیجی‌کالا را ",(0,o.jsx)("br",{}),"دریافت کنید."]}),(0,o.jsx)(e8.J,{buttonClassName:tC().button,className:tC().installApp,onDataTracker:eu.WO})]})}var tN=n(23665),tk=n.n(tN);function tI(e){var t=e.author,n=e.postId;return e.followingUserName,(0,o.jsxs)("section",{className:"flex justify-between items-center px-4 py-2",children:[(0,o.jsx)(r.r,{to:(0,c.kK)(t.authorUsername),"data-testid":"author-profile",children:(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsx)(i.E,{width:32,height:32,className:"shrink-0 ml-2",imageClassName:"rounded-circle",image:null==t?void 0:t.authorPhoto,src:x.C,alt:null==t?void 0:t.authorUsername}),(0,o.jsx)("span",{className:"text-body-1 text-neutral-700",children:null==t?void 0:t.authorUsername})]})}),!t.authorIsFollowing&&(0,o.jsx)(en.n,{"data-testid":"follow-unfollow-button",className:(0,K.d)(tk().followUnfollowButton),isFollowing:null==t?void 0:t.authorIsFollowing,username:null==t?void 0:t.authorUsername,size:"small",isNotFollowLabel:"دنبال کردن",onDataTracker:function(){return(0,eu.UD)({postAuthorId:null==t?void 0:t.authorId,postId:n,followingUserName:null==t?void 0:t.authorUsername})}})]})}var tw=n(79075),ty=n.n(tw);function tb(e){var t=e.followingUserName,n=(0,p.d)(),s=n.isOpen,i=n.onOpen,r=n.onClose,a=(0,p.d)(),l=a.onOpen,u=a.isOpen,c=a.onClose,d=(0,U.Z)((0,E.useState)(),2),m=d[0],f=d[1],h=(0,U.Z)((0,E.useState)(!1),2),x=h[0],C=h[1],j=(0,U.Z)((0,E.useState)(),2),N=j[0],k=j[1],I=(0,T.a)({apiMethod:X}),w=I.items,y=I.pending,b=I.data,S=I.fetchNextPage,P=(0,E.useRef)(!0),L=(0,E.useMemo)(function(){var e=Object.entries(w||{}).filter(function(e){var t=(0,U.Z)(e,2)[1];return!(0,A.x)(t)}).flatMap(function(e){var t=(0,U.Z)(e,2);return(t[0],t[1]).posts||[]});return"iOS"!==g.BF?e.slice(0,10):e},[w]),R=function(e){f(e)},B=(0,ed.S)({onIntersect:function(){C(!0)},enabled:!y&&10===L.length}).targetRef,F=(b||{}).pager,z=(null==F?void 0:F.pagerCurrentPage)<(null==F?void 0:F.pagerTotalPages),D=(0,ed.S)({onIntersect:function(){z&&(P.current=!1,S())},threshold:1,rootMargin:"0px",enabled:!y&&z}).targetRef,J=function(e,t){var n;k({id:e,index:t}),(0,eu.LW)({productId:null==N?void 0:N.id,placeIndex:null==N?void 0:N.index,postId:null==m?void 0:m.postId,authorId:null==m?void 0:null===(n=m.postAuthor)||void 0===n?void 0:n.authorId})};return y&&P.current?(0,o.jsx)(ev,{}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"py-1 bg-app-background-dark"}),L.map(function(e,n){return(0,o.jsxs)("section",{className:"bg-white mt-1",children:[(0,o.jsx)(tI,{author:e.postAuthor,postId:null==e?void 0:e.postId,followingUserName:t}),(0,o.jsx)(tx,{post:e,handlePost:R,onOpenCommentModal:i,postIndex:n,followingUserName:t}),(0,o.jsx)(el,{post:e,containerClassName:"my-3",followingUserName:t,"data-testid":"show-likes"}),(0,o.jsx)(tg,{postCaption:e.postCaption,postTitle:e.postTitle}),(0,o.jsx)(G.k,{"data-testid":"product-card",className:"px-5 pt-3",products:e.postProducts,productOnClick:J}),(0,o.jsx)("p",{className:"text-body-1 text-neutral-600 px-4 py-1 mx-5 mt-3",children:(0,Z.U)(e.postCreatedAt)}),(0,o.jsx)("div",{className:"py-1 bg-app-background-dark mt-4"})]},e.postId)}),(0,o.jsx)(ec.r,(0,M.Z)({post:m,isOpen:s,onClose:r,hasCloseIcon:!0,commentItemClassName:ty().commentItem,headerHideBottomBorder:!0,commentItemContainerClassName:ty().commentItem},"iOS"!==g.BF&&{inputOnClick:function(){(0,v.p)({message:"برای استفاده از امکانات کامل از اپلیکیشن استفاده کنید.",actionText:"دریافت اپلیکیشن",actionFunction:function(){l(),(0,eu.WO)()}})}},"iOS"!==g.BF&&{inputDisabled:!0})),(0,o.jsx)(O,{onClose:c,isOpen:u}),(0,o.jsx)("div",{ref:B}),x&&"iOS"!==g.BF&&(0,o.jsx)(tj,{}),z&&"iOS"===g.BF&&(0,o.jsx)("div",{className:"w-full py-4 flex items-center justify-center",ref:D,children:(0,o.jsx)(_.g,{size:24})})]})}var tS=(0,h.D)({component:function(){var e=(0,m.v)(f.p.isLoggedIn),t=(0,p.d)(),n=t.onOpen,l=t.isOpen,u=t.onClose,h=function(){(0,v.p)({message:"برای استفاده از امکانات کامل از اپلیکیشن استفاده کنید.",actionText:"دریافت اپلیکیشن",actionFunction:function(){n(),(0,eu.WO)()}})},g=(0,d.V)({apiMethod:e?P:null}).data||{},_=g.user,C=g.notificationCount;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("section",{className:"flex items-center justify-between px-4 shadow-1-bottom",children:[(0,o.jsx)(a.mQ,{className:"w-20",children:(0,o.jsx)(a.td,{className:"lg:border-complete-b-200",children:(0,o.jsx)(a.OK,{className:"w-20 px-2 py-3",children:(0,o.jsx)("div",{children:"برای شما"})})})}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-5",children:[(0,o.jsx)(s.J,{icon:"cube-action-search",size:24,onClick:h,"data-testid":"search-icon"}),(0,o.jsx)(s.J,{icon:"cube-alert-notification-outline",count:C,countBgColor:"primary",countClassName:"w-full text-neutral-000",size:24,onClick:h,"data-testid":"notification-icon"}),(0,o.jsx)(r.r,{to:c.DF,children:(0,o.jsx)(i.E,{width:32,height:32,className:"shrink-0 ml-2",imageClassName:"rounded-circle",image:null==_?void 0:_.photo,src:x.C,alt:null==_?void 0:_.username,"data-testid":"profile-icon"})})]})]}),(0,o.jsx)(tb,{followingUserName:null==_?void 0:_.username}),(0,o.jsx)(O,{onClose:u,isOpen:l})]})},layoutProps:{type:l.B.MAGNET},pageActivatorFeature:u.X.MAGNET})},42067:function(e,t,n){"use strict";n.d(t,{OK:function(){return o.OK},mQ:function(){return o.mQ},nP:function(){return o.nP},td:function(){return o.td},x4:function(){return o.x4}});var o=n(64091)},51207:function(e,t,n){"use strict";n.d(t,{S:function(){return o.S1}});var o=n(18687)},29078:function(e){e.exports={pagination:"styles_pagination__v4cV2",currentSlideNumber:"styles_currentSlideNumber__K7Vi9",sliderContainer:"styles_sliderContainer__wuxyN",slider:"styles_slider__QmtBk",slider__arrow:"styles_slider__arrow__myacE",slider__navigator:"styles_slider__navigator__UphJt",slider__pagination:"styles_slider__pagination__uJXGd","slider__pagination--active":"styles_slider__pagination--active__XHxoY",progressBar:"styles_progressBar__P5xJZ",overlay:"styles_overlay__v1vA9"}},78631:function(e){e.exports={commentItem:"styles_commentItem__MA8yJ",modal:"styles_modal__zgvX3"}},26514:function(e){e.exports={likeText:"styles_likeText__LPySa",likeContainer:"styles_likeContainer__EPPGL",endOfReelsContainer:"styles_endOfReelsContainer__qTiJA",animationImage:"styles_animationImage__QLEjy",scroll:"styles_scroll__ypYnv",button:"styles_button__zkf7C",installApp:"styles_installApp__7u6Nz"}},5257:function(e){e.exports={productBackground:"styles_productBackground__PGIZR"}},57955:function(e){e.exports={overlay:"styles_overlay__kYs2C"}},32e3:function(e){e.exports={postSkeleton:"styles_postSkeleton__YGrr1",avatarSkeleton:"styles_avatarSkeleton__L0hWr",usernameSkeleton:"styles_usernameSkeleton__XFl1_",imageSkeleton:"styles_imageSkeleton__io7rG",contentSkeleton:"styles_contentSkeleton__8Bn7S"}},67090:function(e){e.exports={shareContainer:"styles_shareContainer__XrCwQ",noSelect:"styles_noSelect__B_dzG"}},20096:function(e){e.exports={imageBackground:"styles_imageBackground__0l5LG",button:"styles_button__Mkl23",installApp:"styles_installApp__u5o6w"}},89618:function(e){e.exports={mainContainer:"styles_mainContainer__mp1AU",videoContainer:"styles_videoContainer__bven6",slider:"styles_slider__TXNrL",slider__arrow:"styles_slider__arrow__lpYjx",slider__navigator:"styles_slider__navigator___RjtT",slider__pagination:"styles_slider__pagination__cezEo","slider__pagination--active":"styles_slider__pagination--active__sm5vT",clickableClass:"styles_clickableClass__pOBdD",sliderContainer:"styles_sliderContainer__zr0bP"}},23665:function(e){e.exports={followUnfollowButton:"styles_followUnfollowButton__z6T_R"}},79075:function(e){e.exports={commentItem:"styles_commentItem___hEvu"}},27525:function(e){e.exports={like:"styles_like__FXCf8",scaleUp:"styles_scaleUp__q1hE9",fadeOut:"styles_fadeOut__fHsD4"}},14767:function(e){e.exports={bottomSheetContainer:"styles_bottomSheetContainer__nuqjQ"}},25127:function(e){e.exports={followUnfollowButton:"styles_followUnfollowButton__VMikO"}}},function(e){e.O(0,[3325,5338,6547,3459,6023,960,5480,9911,1334,151,5733,4707,9774,2888,179],function(){return e(e.s=29851)}),_N_E=e.O()}]);